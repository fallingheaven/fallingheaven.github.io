<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="å•ä¾‹æ¨¡å¼ å®ç°æ–¹æ³•ï¼ˆC#ï¼‰ é¥¿æ±‰å¼ 1 2 3 4 5 6 7 8 9 public class Singleton { private static readonly Singleton _instance = new Singleton(); // ç§æœ‰æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å¤–éƒ¨å®ä¾‹åŒ– private Singleton() {} public static Singleton Instance => _instance; } æ‡’æ±‰å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 public class Singleton { private static Singleton _instance; private Singleton() {} public static Singleton Instance { get { if (_instance == null) { _instance = new Singleton(); } return _instance; } } } // åŒé‡é”å®š public class Singleton { private static Singleton _instance; private static readonly object _lock = new object(); private Singleton() {} public static Singleton Instance { get { if (_instance == null) { lock (_lock) { if (_instance == null) { _instance = new Singleton(); } } } return _instance; } } } Lazy 1 2 3 4 5 6 7 8 public class Singleton { private static readonly Lazy<Singleton> _instance = new Lazy<Singleton>(() => new Singleton()); private Singleton() {} public static Singleton Instance => _instance.Value; } é™æ€æ„é€  1 2 3 4 5 6 7 8 9 10 11 12 13 public class Singleton { private static readonly Singleton _instance; static Singleton() { _instance = new Singleton(); } private Singleton() {} public static Singleton Instance => _instance; } CASåŸå­æ“ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 public class Singleton { private static volatile Singleton _instance; private Singleton() {} public static Singleton Instance { get { // ç¬¬ä¸€æ¬¡æ£€æŸ¥ï¼šå¦‚æœå®ä¾‹å·²åˆ›å»ºï¼Œç›´æ¥è¿”å› if (_instance != null) return _instance; // ä½¿ç”¨ CAS æ¥åŸå­æ€§åœ°åˆ›å»ºå•ä¾‹å®ä¾‹ Interlocked.CompareExchange(ref _instance, new Singleton(), null); return _instance; // è¿”å›å®ä¾‹ï¼ˆå¯èƒ½å·²ç»æ˜¯å…¶ä»–çº¿ç¨‹åˆ›å»ºçš„ï¼‰ } } } // CompareExchangeç­‰æ•ˆäºä»¥ä¸‹ä»£ç ï¼Œç”±äºè¿™ä¸ªå®ƒæ˜¯åŸå­æ“ä½œï¼Œå°±ä¸éœ€è¦åŠ é” // if (_instance == null) // lock(_instance) //\t{ //\t_instance = new Singleton(); // } å…¶ä»– å…³äºçº¿ç¨‹å®‰å…¨ \u200b\té¥¿æ±‰å¼ã€åŒé‡é”å®šæ‡’æ±‰å¼ã€Lazyã€é™æ€æ„é€ ã€CASéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„\n"><title>è®¾è®¡æ¨¡å¼æ¦‚è§ˆ</title>
<link rel=canonical href=https://fallingheaven.github.io/p/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%A7%88/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="è®¾è®¡æ¨¡å¼æ¦‚è§ˆ"><meta property='og:description' content="å•ä¾‹æ¨¡å¼ å®ç°æ–¹æ³•ï¼ˆC#ï¼‰ é¥¿æ±‰å¼ 1 2 3 4 5 6 7 8 9 public class Singleton { private static readonly Singleton _instance = new Singleton(); // ç§æœ‰æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å¤–éƒ¨å®ä¾‹åŒ– private Singleton() {} public static Singleton Instance => _instance; } æ‡’æ±‰å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 public class Singleton { private static Singleton _instance; private Singleton() {} public static Singleton Instance { get { if (_instance == null) { _instance = new Singleton(); } return _instance; } } } // åŒé‡é”å®š public class Singleton { private static Singleton _instance; private static readonly object _lock = new object(); private Singleton() {} public static Singleton Instance { get { if (_instance == null) { lock (_lock) { if (_instance == null) { _instance = new Singleton(); } } } return _instance; } } } Lazy 1 2 3 4 5 6 7 8 public class Singleton { private static readonly Lazy<Singleton> _instance = new Lazy<Singleton>(() => new Singleton()); private Singleton() {} public static Singleton Instance => _instance.Value; } é™æ€æ„é€  1 2 3 4 5 6 7 8 9 10 11 12 13 public class Singleton { private static readonly Singleton _instance; static Singleton() { _instance = new Singleton(); } private Singleton() {} public static Singleton Instance => _instance; } CASåŸå­æ“ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 public class Singleton { private static volatile Singleton _instance; private Singleton() {} public static Singleton Instance { get { // ç¬¬ä¸€æ¬¡æ£€æŸ¥ï¼šå¦‚æœå®ä¾‹å·²åˆ›å»ºï¼Œç›´æ¥è¿”å› if (_instance != null) return _instance; // ä½¿ç”¨ CAS æ¥åŸå­æ€§åœ°åˆ›å»ºå•ä¾‹å®ä¾‹ Interlocked.CompareExchange(ref _instance, new Singleton(), null); return _instance; // è¿”å›å®ä¾‹ï¼ˆå¯èƒ½å·²ç»æ˜¯å…¶ä»–çº¿ç¨‹åˆ›å»ºçš„ï¼‰ } } } // CompareExchangeç­‰æ•ˆäºä»¥ä¸‹ä»£ç ï¼Œç”±äºè¿™ä¸ªå®ƒæ˜¯åŸå­æ“ä½œï¼Œå°±ä¸éœ€è¦åŠ é” // if (_instance == null) // lock(_instance) //\t{ //\t_instance = new Singleton(); // } å…¶ä»– å…³äºçº¿ç¨‹å®‰å…¨ \u200b\té¥¿æ±‰å¼ã€åŒé‡é”å®šæ‡’æ±‰å¼ã€Lazyã€é™æ€æ„é€ ã€CASéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„\n"><meta property='og:url' content='https://fallingheaven.github.io/p/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%A7%88/'><meta property='og:site_name' content='ä¸ªäººåšå®¢'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='è®¾è®¡æ¨¡å¼'><meta property='article:published_time' content='2025-04-20T00:00:00+00:00'><meta property='article:modified_time' content='2025-04-20T00:00:00+00:00'><meta name=twitter:title content="è®¾è®¡æ¨¡å¼æ¦‚è§ˆ"><meta name=twitter:description content="å•ä¾‹æ¨¡å¼ å®ç°æ–¹æ³•ï¼ˆC#ï¼‰ é¥¿æ±‰å¼ 1 2 3 4 5 6 7 8 9 public class Singleton { private static readonly Singleton _instance = new Singleton(); // ç§æœ‰æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å¤–éƒ¨å®ä¾‹åŒ– private Singleton() {} public static Singleton Instance => _instance; } æ‡’æ±‰å¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 public class Singleton { private static Singleton _instance; private Singleton() {} public static Singleton Instance { get { if (_instance == null) { _instance = new Singleton(); } return _instance; } } } // åŒé‡é”å®š public class Singleton { private static Singleton _instance; private static readonly object _lock = new object(); private Singleton() {} public static Singleton Instance { get { if (_instance == null) { lock (_lock) { if (_instance == null) { _instance = new Singleton(); } } } return _instance; } } } Lazy 1 2 3 4 5 6 7 8 public class Singleton { private static readonly Lazy<Singleton> _instance = new Lazy<Singleton>(() => new Singleton()); private Singleton() {} public static Singleton Instance => _instance.Value; } é™æ€æ„é€  1 2 3 4 5 6 7 8 9 10 11 12 13 public class Singleton { private static readonly Singleton _instance; static Singleton() { _instance = new Singleton(); } private Singleton() {} public static Singleton Instance => _instance; } CASåŸå­æ“ä½œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 public class Singleton { private static volatile Singleton _instance; private Singleton() {} public static Singleton Instance { get { // ç¬¬ä¸€æ¬¡æ£€æŸ¥ï¼šå¦‚æœå®ä¾‹å·²åˆ›å»ºï¼Œç›´æ¥è¿”å› if (_instance != null) return _instance; // ä½¿ç”¨ CAS æ¥åŸå­æ€§åœ°åˆ›å»ºå•ä¾‹å®ä¾‹ Interlocked.CompareExchange(ref _instance, new Singleton(), null); return _instance; // è¿”å›å®ä¾‹ï¼ˆå¯èƒ½å·²ç»æ˜¯å…¶ä»–çº¿ç¨‹åˆ›å»ºçš„ï¼‰ } } } // CompareExchangeç­‰æ•ˆäºä»¥ä¸‹ä»£ç ï¼Œç”±äºè¿™ä¸ªå®ƒæ˜¯åŸå­æ“ä½œï¼Œå°±ä¸éœ€è¦åŠ é” // if (_instance == null) // lock(_instance) //\t{ //\t_instance = new Singleton(); // } å…¶ä»– å…³äºçº¿ç¨‹å®‰å…¨ \u200b\té¥¿æ±‰å¼ã€åŒé‡é”å®šæ‡’æ±‰å¼ã€Lazyã€é™æ€æ„é€ ã€CASéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„\n"></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_fb8b45451f34c1b8.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>ä¸ªäººåšå®¢</a></h1><h2 class=site-description>éšä¾¿å†™å†™</h2></div></header><ol class=menu-social><li><a href=https://github.com/fallingheaven target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>ä¸»é¡µ</span></a></li><li><a href=/%E5%85%B3%E4%BA%8E/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>å…³äº</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#å•ä¾‹æ¨¡å¼>å•ä¾‹æ¨¡å¼</a><ol><li><a href=#å®ç°æ–¹æ³•c>å®ç°æ–¹æ³•ï¼ˆC#ï¼‰</a><ol><li><a href=#é¥¿æ±‰å¼>é¥¿æ±‰å¼</a></li><li><a href=#æ‡’æ±‰å¼>æ‡’æ±‰å¼</a></li><li><a href=#lazy>Lazy<t></a></li><li><a href=#é™æ€æ„é€ >é™æ€æ„é€ </a></li><li><a href=#casåŸå­æ“ä½œ>CASåŸå­æ“ä½œ</a></li></ol></li><li><a href=#å…¶ä»–>å…¶ä»–</a><ol><li><a href=#å…³äºçº¿ç¨‹å®‰å…¨>å…³äºçº¿ç¨‹å®‰å…¨</a></li></ol></li></ol></li><li><a href=#é€‚é…å™¨æ–¹æ³•>é€‚é…å™¨æ–¹æ³•</a><ol><li><a href=#ç»„åˆå®ç°>ç»„åˆå®ç°</a></li><li><a href=#ç»§æ‰¿å®ç°>ç»§æ‰¿å®ç°</a></li><li><a href=#åŒå‘é€‚é…å™¨>åŒå‘é€‚é…å™¨</a></li></ol></li><li><a href=#æ¨¡æ¿æ–¹æ³•æ¨¡å¼>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</a><ol><li><a href=#é’©å­æ–¹æ³•>é’©å­æ–¹æ³•</a></li><li><a href=#iocinversion-of-controlæ§åˆ¶åè½¬>IoCï¼ˆInversion of Controlï¼Œæ§åˆ¶åè½¬ï¼‰</a></li><li><a href=#dipdependency-inversion-principleä¾èµ–å€’ç½®åŸåˆ™>DIPï¼ˆDependency Inversion Principleï¼Œä¾èµ–å€’ç½®åŸåˆ™ï¼‰</a></li><li><a href=#dependency-injectionä¾èµ–æ³¨å…¥>Dependency Injectionï¼ˆä¾èµ–æ³¨å…¥ï¼‰</a></li></ol></li><li><a href=#è¿­ä»£å™¨>è¿­ä»£å™¨</a></li><li><a href=#å·¥å‚æ¨¡å¼>å·¥å‚æ¨¡å¼</a><ol><li><a href=#ocpæ€æƒ³å¼€é—­åŸåˆ™>OCPæ€æƒ³ï¼ˆå¼€é—­åŸåˆ™ï¼‰</a></li><li><a href=#å®ç°æ–¹æ³•>å®ç°æ–¹æ³•</a><ol><li><a href=#ç®€å•å·¥å‚>ç®€å•å·¥å‚</a></li><li><a href=#å·¥å‚æ–¹æ³•>å·¥å‚æ–¹æ³•</a></li><li><a href=#æŠ½è±¡å·¥å‚>æŠ½è±¡å·¥å‚</a><ol><li><a href=#å•æŠ½è±¡çš„å®ç°>å•æŠ½è±¡çš„å®ç°</a></li><li><a href=#å¤šæŠ½è±¡çš„å®ç°>å¤šæŠ½è±¡çš„å®ç°</a></li><li><a href=#å€ŸåŠ©å»ºé€ è€…æ¨¡å¼çš„å®ç°>å€ŸåŠ©å»ºé€ è€…æ¨¡å¼çš„å®ç°</a></li></ol></li></ol></li></ol></li><li><a href=#åŸå‹æ–¹æ³•>åŸå‹æ–¹æ³•</a><ol><li><a href=#å®ç°æ–¹æ³•-1>å®ç°æ–¹æ³•</a></li><li><a href=#æ·±æ‹·è´>æ·±æ‹·è´</a></li></ol></li><li><a href=#å»ºé€ è€…æ¨¡å¼>å»ºé€ è€…æ¨¡å¼</a></li><li><a href=#æ¡¥æ¥æ¨¡å¼>æ¡¥æ¥æ¨¡å¼</a><ol><li><a href=#å®ç°æ–¹æ³•-2>å®ç°æ–¹æ³•</a></li></ol></li><li><a href=#è£…é¥°å™¨æ¨¡å¼>è£…é¥°å™¨æ¨¡å¼</a></li><li><a href=#çŠ¶æ€æ¨¡å¼>çŠ¶æ€æ¨¡å¼</a></li><li><a href=#è§‚å¯Ÿè€…æ¨¡å¼>è§‚å¯Ÿè€…æ¨¡å¼</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/>è®¾è®¡æ¨¡å¼</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E6%A6%82%E8%A7%88/>è®¾è®¡æ¨¡å¼æ¦‚è§ˆ</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Apr 20, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 20 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h2 id=å•ä¾‹æ¨¡å¼>å•ä¾‹æ¨¡å¼</h2><h3 id=å®ç°æ–¹æ³•c>å®ç°æ–¹æ³•ï¼ˆC#ï¼‰</h3><h4 id=é¥¿æ±‰å¼>é¥¿æ±‰å¼</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Singleton</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=k>readonly</span> <span class=n>Singleton</span> <span class=n>_instance</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Singleton</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// ç§æœ‰æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å¤–éƒ¨å®ä¾‹åŒ–</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Singleton</span><span class=p>()</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Singleton</span> <span class=n>Instance</span> <span class=p>=&gt;</span> <span class=n>_instance</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æ‡’æ±‰å¼>æ‡’æ±‰å¼</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Singleton</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Singleton</span> <span class=n>_instance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Singleton</span><span class=p>()</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Singleton</span> <span class=n>Instance</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>get</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>_instance</span> <span class=p>==</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>_instance</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Singleton</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>_instance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// åŒé‡é”å®š</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Singleton</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>Singleton</span> <span class=n>_instance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=k>readonly</span> <span class=kt>object</span> <span class=n>_lock</span> <span class=p>=</span> <span class=k>new</span> <span class=kt>object</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Singleton</span><span class=p>()</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Singleton</span> <span class=n>Instance</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>get</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>_instance</span> <span class=p>==</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>lock</span> <span class=p>(</span><span class=n>_lock</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=p>(</span><span class=n>_instance</span> <span class=p>==</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=n>_instance</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Singleton</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>_instance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=lazy>Lazy<t></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Singleton</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=k>readonly</span> <span class=n>Lazy</span><span class=p>&lt;</span><span class=n>Singleton</span><span class=p>&gt;</span> <span class=n>_instance</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Lazy</span><span class=p>&lt;</span><span class=n>Singleton</span><span class=p>&gt;(()</span> <span class=p>=&gt;</span> <span class=k>new</span> <span class=n>Singleton</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Singleton</span><span class=p>()</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Singleton</span> <span class=n>Instance</span> <span class=p>=&gt;</span> <span class=n>_instance</span><span class=p>.</span><span class=n>Value</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=é™æ€æ„é€ >é™æ€æ„é€ </h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Singleton</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=k>readonly</span> <span class=n>Singleton</span> <span class=n>_instance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>static</span> <span class=n>Singleton</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_instance</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Singleton</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Singleton</span><span class=p>()</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Singleton</span> <span class=n>Instance</span> <span class=p>=&gt;</span> <span class=n>_instance</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=casåŸå­æ“ä½œ>CASåŸå­æ“ä½œ</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Singleton</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=kd>volatile</span> <span class=n>Singleton</span> <span class=n>_instance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Singleton</span><span class=p>()</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=n>Singleton</span> <span class=n>Instance</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>get</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// ç¬¬ä¸€æ¬¡æ£€æŸ¥ï¼šå¦‚æœå®ä¾‹å·²åˆ›å»ºï¼Œç›´æ¥è¿”å›</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>_instance</span> <span class=p>!=</span> <span class=kc>null</span><span class=p>)</span> <span class=k>return</span> <span class=n>_instance</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c1>// ä½¿ç”¨ CAS æ¥åŸå­æ€§åœ°åˆ›å»ºå•ä¾‹å®ä¾‹</span>
</span></span><span class=line><span class=cl>            <span class=n>Interlocked</span><span class=p>.</span><span class=n>CompareExchange</span><span class=p>(</span><span class=k>ref</span> <span class=n>_instance</span><span class=p>,</span> <span class=k>new</span> <span class=n>Singleton</span><span class=p>(),</span> <span class=kc>null</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>_instance</span><span class=p>;</span>  <span class=c1>// è¿”å›å®ä¾‹ï¼ˆå¯èƒ½å·²ç»æ˜¯å…¶ä»–çº¿ç¨‹åˆ›å»ºçš„ï¼‰</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// CompareExchangeç­‰æ•ˆäºä»¥ä¸‹ä»£ç ï¼Œç”±äºè¿™ä¸ªå®ƒæ˜¯åŸå­æ“ä½œï¼Œå°±ä¸éœ€è¦åŠ é”</span>
</span></span><span class=line><span class=cl><span class=c1>// if (_instance == null) </span>
</span></span><span class=line><span class=cl><span class=c1>// 		lock(_instance)</span>
</span></span><span class=line><span class=cl><span class=c1>//		{</span>
</span></span><span class=line><span class=cl><span class=c1>//			_instance = new Singleton();</span>
</span></span><span class=line><span class=cl><span class=c1>// 		}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=å…¶ä»–>å…¶ä»–</h3><h4 id=å…³äºçº¿ç¨‹å®‰å…¨>å…³äºçº¿ç¨‹å®‰å…¨</h4><p>â€‹ é¥¿æ±‰å¼ã€åŒé‡é”å®šæ‡’æ±‰å¼ã€Lazyã€é™æ€æ„é€ ã€CASéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„</p><h2 id=é€‚é…å™¨æ–¹æ³•>é€‚é…å™¨æ–¹æ³•</h2><p>â€‹ å…¶æ€æƒ³æ˜¯é€šè¿‡<strong>ç»Ÿä¸€çš„æ¥å£</strong>å†™é€‚é…å™¨ï¼Œæ¥é€‚é…ä¸åŒçš„ç³»ç»Ÿ
â€‹ å¦‚è§¦å±è¾“å…¥çš„XYä¸é¼ æ ‡è¾“å…¥çš„XYï¼Œä¸¤è€…æ–¹æ³•ä¸åŒçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡å®ç°ç›¸åŒçš„æ¥å£è·å–åˆ°ä¸åŒç³»ç»Ÿçš„æ–¹æ³•
â€‹ åˆæˆ–è€…ï¼Œæœ‰ä¸€ä¸ªzipçš„å‹ç¼©å™¨å’Œä¸€ä¸ªrarçš„å‹ç¼©å™¨ï¼Œæƒ³ç”¨ä¸€ä¸ªç»Ÿä¸€çš„å‹ç¼©ã€è§£å‹æ–¹æ³•æ¥ä½¿ç”¨ï¼Œå¯ä»¥å†™ä¸¤ä¸ªé€‚é…å™¨ï¼Œéƒ½æœ‰å‹ç¼©ã€è§£å‹æ–¹æ³•</p><p>â€‹ ç»„åˆå®ç°ç±»ä¼¼åŒ…è£…ï¼Œç»§æ‰¿å®ç°ç±»ä¼¼æ‰©å±•ï¼Œ
â€‹ å¹¶ä¸”ï¼Œé€‚é…å™¨åœ¨å¯¹å…·ä½“ç±»è¿›è¡Œé€‚é…æ—¶ï¼Œå¯ä»¥ä¸ç”¨ç»§æ‰¿æ¥å£ï¼ˆå¦‚ä¸‹é¢çš„Zipå’ŒRarï¼‰</p><h3 id=ç»„åˆå®ç°>ç»„åˆå®ç°</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// Adapteeï¼šéœ€è¦é€‚é…çš„ç±»</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Zip</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>ZipComp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Zip Compress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>ZipDecomp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Zip Decompress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Rar</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>RarComp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Rar Compress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>RarDecomp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Rar Decompress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ICompressorï¼šç›®æ ‡æ¥å£</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>ICompressor</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Compress</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Decompress</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// é€‚é…å™¨ç±»ï¼ŒåŒ…å«å…³ç³»è¿›è¡Œå¼•ç”¨</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>ZipAdapter</span> <span class=p>:</span> <span class=n>ICompressor</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=n>Zip</span> <span class=n>_zip</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>ZipAdapter</span><span class=p>(</span><span class=n>Zip</span> <span class=n>zip</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_zip</span> <span class=p>=</span> <span class=n>zip</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Comp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Zip Compress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Decomp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Zip Decompress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>RarAdapter</span> <span class=p>:</span> <span class=n>ICompressor</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=n>Rar</span> <span class=n>_rar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>ZipAdapter</span><span class=p>(</span><span class=n>Rar</span> <span class=n>rar</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_rar</span> <span class=p>=</span> <span class=n>rar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Comp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Rar Compress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Decomp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Rar Decompress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Clientï¼šå®¢æˆ·ç«¯</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Client</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Run</span><span class=p>(</span><span class=kt>bool</span> <span class=n>useZip</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>zip</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Zip</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>rar</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Rar</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>zipAdapter</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ZipAdapter</span><span class=p>(</span><span class=n>zip</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>rarAdapter</span> <span class=p>=</span> <span class=k>new</span> <span class=n>RarAdapter</span><span class=p>(</span><span class=n>rar</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>ICompressor</span> <span class=n>compressor</span> <span class=p>=</span> <span class=n>useZip</span><span class=p>?</span> <span class=n>zipAdapter</span> <span class=p>:</span> <span class=n>rarAdapter</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>compressor</span><span class=p>.</span><span class=n>Comp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>compressor</span><span class=p>.</span><span class=n>Decomp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=ç»§æ‰¿å®ç°>ç»§æ‰¿å®ç°</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// Adapteeï¼šéœ€è¦é€‚é…çš„ç±»</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Zip</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>ZipComp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Zip Compress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>ZipDecomp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Zip Decompress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Rar</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>RarComp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Rar Compress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>RarDecomp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Debug</span><span class=p>.</span><span class=n>Log</span><span class=p>(</span><span class=s>&#34;Rar Decompress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ICompressorï¼šç›®æ ‡æ¥å£</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>ICompressor</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Compress</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Decompress</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// é€‚é…å™¨ç±»ï¼Œç»§æ‰¿å®ç°ï¼Œç±»ä¼¼äºåœ¨åŸç±»ä¸­é¢å¤–åŠ äº†ä¸¤ä¸ªé€šç”¨æ–¹æ³•</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>ZipAdapter</span> <span class=p>:</span> <span class=n>Zip</span><span class=p>,</span> <span class=n>ICompressor</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Comp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ZipComp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Decomp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ZipDecomp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>RarAdapter</span> <span class=p>:</span> <span class=n>Rar</span><span class=p>,</span> <span class=n>ICompressor</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Comp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>RarComp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Decomp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>RarDecomp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Clientï¼šå®¢æˆ·ç«¯</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Client</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Run</span><span class=p>(</span><span class=kt>bool</span> <span class=n>useZip</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=kt>var</span> <span class=n>zipAdapter</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ZipAdapter</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=kt>var</span> <span class=n>rarAdapter</span> <span class=p>=</span> <span class=k>new</span> <span class=n>RarAdapter</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>ICompressor</span> <span class=n>compressor</span> <span class=p>=</span> <span class=n>useZip</span><span class=p>?</span> <span class=n>zipAdapter</span> <span class=p>:</span> <span class=n>rarAdapter</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>compressor</span><span class=p>.</span><span class=n>Comp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>compressor</span><span class=p>.</span><span class=n>Decomp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=åŒå‘é€‚é…å™¨>åŒå‘é€‚é…å™¨</h3><p>â€‹ è¿™ä¸ªç®€å•æ¥è¯´ï¼Œå°±æ˜¯éœ€è¦zipå’Œrarç›¸äº’æ”¯æŒï¼Œæˆ‘æœ¬ä»¥ä¸ºä¸Šè¿°ä»£ç æŸç§ç¨‹åº¦ä¸Šå®ç°äº†è¿™ä¸€åŠŸèƒ½ï¼Œä½†å®é™…ä¸Šï¼Œä¸Šè¿°ä»£ç æ˜¯å°†ä¸¤ç§æ¥å£é€šè¿‡å•å‘é€‚é…å™¨é€‚é…åˆ°äº†é€šç”¨æ¥å£ä¸Šã€‚
â€‹ åŒå‘é€‚é…å™¨åˆ™æ˜¯ç”¨æ¥zipå‘raræ¥å£è½¬æ¢ï¼Œä»¥åŠraræ¥å£å‘zipæ¥å£è½¬æ¢ï¼Œè°ƒç”¨zipæ–¹æ³•å®é™…ä¸Šè°ƒç”¨çš„raræ–¹æ³•ï¼Œ
â€‹ å¯¹äºä¸èƒ½å¤šé‡ç»§æ‰¿çš„è¯­è¨€ï¼ŒåŒå‘é€‚é…å™¨ç”±ç»„åˆå®ç°ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// Zip ç±»</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Zip</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>ZipCompress</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;Zip: Compress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>ZipDecompress</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;Zip: Decompress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Rar ç±»</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Rar</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>RarCompress</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;Rar: Compress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>RarDecompress</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;Rar: Decompress&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// åŒå‘é€‚é…å™¨</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>BidirectionalAdapter</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Zip</span> <span class=n>_zip</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Rar</span> <span class=n>_rar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// æ„é€ æ–¹æ³•ï¼Œç”¨äºé€‚é… Zip</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>BidirectionalAdapter</span><span class=p>(</span><span class=n>Zip</span> <span class=n>zip</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_zip</span> <span class=p>=</span> <span class=n>zip</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// æ„é€ æ–¹æ³•ï¼Œç”¨äºé€‚é… Rar</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>BidirectionalAdapter</span><span class=p>(</span><span class=n>Rar</span> <span class=n>rar</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_rar</span> <span class=p>=</span> <span class=n>rar</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// è°ƒç”¨å‹ç¼©æ–¹æ³•</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Compress</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>_zip</span> <span class=p>!=</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_zip</span><span class=p>.</span><span class=n>ZipCompress</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>_rar</span> <span class=p>!=</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;Adapting Rar to Zip&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>_rar</span><span class=p>.</span><span class=n>RarCompress</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// è°ƒç”¨è§£å‹æ–¹æ³•</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Decompress</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>_zip</span> <span class=p>!=</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_zip</span><span class=p>.</span><span class=n>ZipDecompress</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>_rar</span> <span class=p>!=</span> <span class=kc>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=s>&#34;Adapting Zip to Rar&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>_rar</span><span class=p>.</span><span class=n>RarDecompress</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=æ¨¡æ¿æ–¹æ³•æ¨¡å¼>æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h2><p>â€‹ å…¶å®å°±æ˜¯æŠ½è±¡ç±»çš„å®ç°ï¼Œå› æ­¤ä¸å¤šèµ˜è¿°</p><h3 id=é’©å­æ–¹æ³•>é’©å­æ–¹æ³•</h3><p>â€‹ å…¶æ€æƒ³åœ¨äºåœ¨å­ç±»ä¸­å®ç°çš„é€»è¾‘ä¼šå½±å“çˆ¶ç±»ä¸­çš„é€»è¾‘
â€‹ å¦‚ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­çš„æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨å­ç±»ä¸­é‡å†™åï¼Œå°±ä¼šå½±å“çˆ¶ç±»ç›¸åº”çš„æ¡ä»¶åˆ¤æ–­</p><h3 id=iocinversion-of-controlæ§åˆ¶åè½¬>IoCï¼ˆInversion of Controlï¼Œæ§åˆ¶åè½¬ï¼‰</h3><p>â€‹ IoC æ˜¯ä¸€ç§è®¾è®¡åŸåˆ™ï¼ŒæŒ‡å°†<strong>å¯¹è±¡çš„åˆ›å»ºæˆ–ä¾èµ–å…³ç³»çš„ç®¡ç†äº¤ç»™å¤–éƒ¨å®¹å™¨</strong>ï¼Œè€Œä¸æ˜¯ç”±å¯¹è±¡è‡ªèº«æ§åˆ¶ã€‚é€šè¿‡ IoCï¼Œå¯ä»¥é™ä½æ¨¡å—ä¹‹é—´çš„è€¦åˆæ€§ï¼Œæé«˜ä»£ç çš„çµæ´»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h3 id=dipdependency-inversion-principleä¾èµ–å€’ç½®åŸåˆ™>DIPï¼ˆDependency Inversion Principleï¼Œä¾èµ–å€’ç½®åŸåˆ™ï¼‰</h3><p>â€‹ é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚
â€‹ æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºå…·ä½“å®ç°ï¼Œå…·ä½“å®ç°åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚
â€‹ ä¹Ÿå°±æ˜¯ç°æœ‰æŠ½è±¡ï¼Œå†å®ç°æŠ½è±¡</p><h3 id=dependency-injectionä¾èµ–æ³¨å…¥>Dependency Injectionï¼ˆä¾èµ–æ³¨å…¥ï¼‰</h3><p>â€‹ ä¾èµ–æ³¨å…¥æ˜¯<strong>å®ç° IoC çš„ä¸€ç§æ–¹å¼</strong>ï¼Œé€šè¿‡å°†ä¾èµ–å¯¹è±¡æ³¨å…¥åˆ°ç›®æ ‡å¯¹è±¡ä¸­ï¼Œè€Œä¸æ˜¯ç›®æ ‡å¯¹è±¡è‡ªå·±åˆ›å»ºä¾èµ–å¯¹è±¡</p><ul><li><p>å¸¸è§çš„ä¾èµ–æ³¨å…¥æ–¹å¼æœ‰ï¼š</p><ul><li><p>æ„é€ å™¨æ³¨å…¥ï¼šé€šè¿‡æ„é€ æ–¹æ³•ä¼ é€’ä¾èµ–ã€‚</p></li><li><p>Setter æ–¹æ³•æ³¨å…¥ï¼šé€šè¿‡ Setter æ–¹æ³•ä¼ é€’ä¾èµ–ã€‚</p></li><li><p>æ¥å£æ³¨å…¥ï¼šé€šè¿‡æ¥å£æ–¹æ³•ï¼ˆå³æ¥å£å®ç°Setteræ–¹æ³•ï¼‰ä¼ é€’ä¾èµ–ã€‚</p></li></ul></li></ul><h2 id=è¿­ä»£å™¨>è¿­ä»£å™¨</h2><p>â€‹ ä¸å…¶è¯´ä¸€ç§æ¨¡å¼ï¼Œä¸å¦‚è¯´æ˜¯å¯¹äºOOADå’Œæ¨¡æ¿æ–¹æ³•çš„å…¸å‹å®è·µ
â€‹ å…¶æ€æƒ³æ˜¯æä¾›ä¸€ç§æ–¹æ³•é¡ºåºï¼ˆä¸ç¡®å®š ï¼‰è®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤º</p><h2 id=å·¥å‚æ¨¡å¼>å·¥å‚æ¨¡å¼</h2><h3 id=ocpæ€æƒ³å¼€é—­åŸåˆ™>OCPæ€æƒ³ï¼ˆå¼€é—­åŸåˆ™ï¼‰</h3><p>â€‹ å¼€é—­åŸåˆ™ (OCP) æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªåŸºæœ¬åŸåˆ™ï¼Œå®ƒæŒ‡å‡ºåº”ç”¨ç¨‹åºå®ä½“ï¼ˆç±»ã€æ¨¡å—ã€æ–¹æ³•ç­‰ï¼‰åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ä½†å¯¹ä¿®æ”¹å…³é—­ã€‚æ¢å¥è¯è¯´ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿåœ¨ä¸æ›´æ”¹ç°æœ‰ä»£ç çš„æƒ…å†µä¸‹å‘åº”ç”¨ç¨‹åºæ·»åŠ æ–°åŠŸèƒ½ã€‚</p><p>â€‹ å¯¹äºæœ¬æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨ä¸ä¿®æ”¹ç°æœ‰å·¥å‚ã€äº§å“ç±»çš„åŒæ—¶ï¼ŒåŠ å…¥æ–°çš„å·¥å‚ã€äº§å“ç­‰</p><h3 id=å®ç°æ–¹æ³•>å®ç°æ–¹æ³•</h3><h4 id=ç®€å•å·¥å‚>ç®€å•å·¥å‚</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// éœ€æ±‚æ˜¯ä¸€ä¸ªå·¥å‚éœ€è¦ç”Ÿäº§ä¸åŒçš„äº§å“</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Factory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>IProduct</span> <span class=n>Create</span><span class=p>(</span><span class=kt>string</span> <span class=n>type</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;A&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        	<span class=k>return</span> <span class=k>new</span> <span class=n>ProductA</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        	<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;B&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        	<span class=k>return</span> <span class=k>new</span> <span class=n>ProductB</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        	<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        	<span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        	<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>IProduct</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>ProductA</span> <span class=p>:</span> <span class=n>IProduct</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>ProductB</span> <span class=p>:</span> <span class=n>IProduct</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=å·¥å‚æ–¹æ³•>å·¥å‚æ–¹æ³•</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// éœ€æ±‚æ˜¯å¤šä¸ªå·¥å‚ï¼Œä¸€ä¸ªå·¥å‚ç”Ÿäº§ä¸€ç§å•†å“</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>IFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>IProduct</span> <span class=n>Create</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Factory</span> <span class=p>:</span> <span class=n>IFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>IProduct</span> <span class=n>Create</span><span class=p>(</span><span class=kt>string</span> <span class=n>type</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;A&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        	<span class=k>return</span> <span class=k>new</span> <span class=n>ProductA</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        	<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;B&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        	<span class=k>return</span> <span class=k>new</span> <span class=n>ProductB</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        	<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        	<span class=k>return</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        	<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>IProduct</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>ProductA</span> <span class=p>:</span> <span class=n>IProduct</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>ProductB</span> <span class=p>:</span> <span class=n>IProduct</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=æŠ½è±¡å·¥å‚>æŠ½è±¡å·¥å‚</h4><p>â€‹ æ˜¯ä¸ºäº†è§£å†³å­˜åœ¨å¤šä¸ªä¸åŒçš„äº§å“æ—ï¼Œæ¯ä¸ªå…·ä½“å·¥å‚ä¼šç”Ÿäº§æŸäº§å“æ—</p><p>â€‹ æ·»åŠ å…·ä½“å·¥å‚ç±»æ˜¯å®¹æ˜“çš„ï¼Œä½†æ·»åŠ å…·ä½“äº§å“æ˜¯éº»çƒ¦çš„ï¼Œéœ€è¦å¯¹å·¥å‚çš„æ–¹æ³•è¿›è¡Œæ‰©å±•ï¼ˆå¦‚æ·»åŠ CreateProductCæ–¹æ³•ï¼‰ï¼Œè¡¨ç°ä¸ºOCPçš„å€¾æ–œæ€§</p><p><strong>å¯¹äºæŠ½è±¡å·¥å‚å’Œå·¥å‚æ¨¡å¼çš„åŒºåˆ«ï¼š</strong></p><p>â€‹ å·¥å‚æ–¹æ³•æ¨¡å¼ï¼šA -> F1ï¼ŒF1 ç”Ÿäº§ P1ï¼›A -> F2ï¼ŒF2 ç”Ÿäº§ P2ã€‚æ¯ä¸ªå·¥å‚åªè´Ÿè´£ç”Ÿäº§ä¸€ç§ç±»å‹çš„äº§å“ã€‚</p><p>â€‹ æŠ½è±¡å·¥å‚æ¨¡å¼ï¼šA -> F1.1ï¼ŒF1.1 ç”Ÿäº§ P1.1ï¼›A -> F1.2ï¼ŒF1.2 ç”Ÿäº§ P1.2ã€‚æ¯ä¸ªå·¥å‚è´Ÿè´£ç”Ÿäº§ä¸€ç»„ç›¸å…³çš„äº§å“</p><h5 id=å•æŠ½è±¡çš„å®ç°>å•æŠ½è±¡çš„å®ç°</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// --- 1. Abstract Products ---</span>
</span></span><span class=line><span class=cl><span class=c1>// å®šä¹‰æ–‡æ¡£ç»„æˆéƒ¨åˆ†ï¼ˆäº§å“ï¼‰çš„æŠ½è±¡æ¥å£</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// åŸºç¡€æ–‡æœ¬å…ƒç´ æ¥å£</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>ITextElement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>string</span> <span class=n>Render</span><span class=p>();</span> <span class=c1>// æ¯ä¸ªå…ƒç´ éƒ½çŸ¥é“å¦‚ä½•å°†è‡ªå·±æ¸²æŸ“æˆå­—ç¬¦ä¸²</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æŠ½è±¡æ ‡é¢˜å…ƒç´ </span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>ITitleElement</span> <span class=p>:</span> <span class=n>ITextElement</span> <span class=p>{</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æŠ½è±¡å†…å®¹å…ƒç´ </span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>IContentElement</span> <span class=p>:</span> <span class=n>ITextElement</span> <span class=p>{</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- 2. Concrete Products ---</span>
</span></span><span class=line><span class=cl><span class=c1>// ä¸ºæ¯ç§æ ¼å¼ï¼ˆMarkdown, HTMLï¼‰å®ç°å…·ä½“çš„æ–‡æ¡£ç»„æˆéƒ¨åˆ†</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- Markdown äº§å“ ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MarkdownTitleElement</span> <span class=p>:</span> <span class=n>ITitleElement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=kt>string</span> <span class=n>_text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>MarkdownTitleElement</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span> <span class=p>{</span> <span class=n>_text</span> <span class=p>=</span> <span class=n>text</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Render</span><span class=p>()</span> <span class=p>=&gt;</span> <span class=s>$&#34;# {_text}\n&#34;</span><span class=p>;</span> <span class=c1>// è¿”å› Markdown æ ‡é¢˜æ ¼å¼</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MarkdownContentElement</span> <span class=p>:</span> <span class=n>IContentElement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=kt>string</span> <span class=n>_text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>MarkdownContentElement</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span> <span class=p>{</span> <span class=n>_text</span> <span class=p>=</span> <span class=n>text</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Render</span><span class=p>()</span> <span class=p>=&gt;</span> <span class=s>$&#34;{_text}\n&#34;</span><span class=p>;</span> <span class=c1>// è¿”å› Markdown å†…å®¹æ ¼å¼</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- HTML äº§å“ ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>HtmlTitleElement</span> <span class=p>:</span> <span class=n>ITitleElement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=kt>string</span> <span class=n>_text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>HtmlTitleElement</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span> <span class=p>{</span> <span class=n>_text</span> <span class=p>=</span> <span class=n>text</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Render</span><span class=p>()</span> <span class=p>=&gt;</span> <span class=s>$&#34;&lt;h1&gt;{_text}&lt;/h1&gt;\n&#34;</span><span class=p>;</span> <span class=c1>// è¿”å› HTML H1 æ ¼å¼</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>HtmlContentElement</span> <span class=p>:</span> <span class=n>IContentElement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=kt>string</span> <span class=n>_text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>HtmlContentElement</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span> <span class=p>{</span> <span class=n>_text</span> <span class=p>=</span> <span class=n>text</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Render</span><span class=p>()</span> <span class=p>=&gt;</span> <span class=s>$&#34;&lt;p&gt;{_text}&lt;/p&gt;\n&#34;</span><span class=p>;</span> <span class=c1>// è¿”å› HTML æ®µè½æ ¼å¼</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- 3. Abstract Factory ---</span>
</span></span><span class=line><span class=cl><span class=c1>// å®šä¹‰åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³äº§å“ï¼ˆæ–‡æœ¬å…ƒç´ ï¼‰çš„æ¥å£</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>ITextDocumentFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ITitleElement</span> <span class=n>CreateTitle</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>IContentElement</span> <span class=n>CreateContent</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=c1>// å¯ä»¥æ·»åŠ æ›´å¤šæ–¹æ³•æ¥åˆ›å»ºå…¶ä»–å…ƒç´ ï¼Œå¦‚ CreateList, CreateLink ç­‰</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- 4. Concrete Factories ---</span>
</span></span><span class=line><span class=cl><span class=c1>// å®ç°æŠ½è±¡å·¥å‚æ¥å£ï¼Œä¸ºç‰¹å®šæ ¼å¼åˆ›å»ºå…·ä½“çš„äº§å“å®ä¾‹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- Markdown å·¥å‚ ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MarkdownDocumentFactory</span> <span class=p>:</span> <span class=n>ITextDocumentFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>ITitleElement</span> <span class=n>CreateTitle</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>MarkdownTitleElement</span><span class=p>(</span><span class=n>text</span><span class=p>);</span> <span class=c1>// ç›´æ¥è¿”å›å…·ä½“äº§å“</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>IContentElement</span> <span class=n>CreateContent</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>MarkdownContentElement</span><span class=p>(</span><span class=n>text</span><span class=p>);</span> <span class=c1>// ç›´æ¥è¿”å›å…·ä½“äº§å“</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- HTML å·¥å‚ ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>HtmlDocumentFactory</span> <span class=p>:</span> <span class=n>ITextDocumentFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>ITitleElement</span> <span class=n>CreateTitle</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>HtmlTitleElement</span><span class=p>(</span><span class=n>text</span><span class=p>);</span> <span class=c1>// ç›´æ¥è¿”å›å…·ä½“äº§å“</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>IContentElement</span> <span class=n>CreateContent</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>HtmlContentElement</span><span class=p>(</span><span class=n>text</span><span class=p>);</span> <span class=c1>// ç›´æ¥è¿”å›å…·ä½“äº§å“</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- 5. Client Code ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>DocumentAssembler</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// å®¢æˆ·ç«¯ä½¿ç”¨å·¥å‚åˆ›å»ºçš„å…ƒç´ åˆ—è¡¨æ¥ç»„è£…æ–‡æ¡£</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>ITextElement</span><span class=p>&gt;</span> <span class=n>_elements</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>ITextElement</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// å®¢æˆ·ç«¯è°ƒç”¨å·¥å‚æ¥åˆ›å»ºé›¶ä»¶ï¼Œç„¶åè‡ªå·±å­˜å‚¨è¿™äº›é›¶ä»¶</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>AddElement</span><span class=p>(</span><span class=n>ITextElement</span> <span class=n>element</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_elements</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=n>element</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// å®¢æˆ·ç«¯è´Ÿè´£å°†æ‰€æœ‰é›¶ä»¶ç»„åˆï¼ˆæ¸²æŸ“ï¼‰æˆæœ€ç»ˆæ–‡æ¡£</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>AssembleDocument</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>StringBuilder</span> <span class=n>finalDocument</span> <span class=p>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=c1>// --- HTML ç‰¹æ®Šå¤„ç†ï¼šæ·»åŠ å¤–å±‚æ ‡ç­¾ ---</span>
</span></span><span class=line><span class=cl>        <span class=c1>// æ³¨æ„ï¼šè¿™ç§æ ¼å¼ç‰¹å®šçš„ç»„è£…é€»è¾‘ç°åœ¨åœ¨å®¢æˆ·ç«¯ï¼Œ</span>
</span></span><span class=line><span class=cl>        <span class=c1>// æˆ–è€…å¯ä»¥å¼•å…¥æ›´å¤æ‚çš„ç»“æ„æ¥å¤„ç†ã€‚</span>
</span></span><span class=line><span class=cl>        <span class=c1>// å¯¹äºçº¯ç²¹çš„æŠ½è±¡å·¥å‚ï¼Œå®¢æˆ·ç«¯é€šå¸¸éœ€è¦çŸ¥é“å¦‚ä½•ç»„åˆã€‚</span>
</span></span><span class=line><span class=cl>        <span class=c1>// å¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ HtmlTitleElementï¼Œæˆ‘ä»¬å¯èƒ½æƒ³æ·»åŠ &lt;html&gt;&lt;body&gt;ç­‰</span>
</span></span><span class=line><span class=cl>        <span class=kt>bool</span> <span class=n>isHtml</span> <span class=p>=</span> <span class=n>_elements</span><span class=p>.</span><span class=n>Count</span> <span class=p>&gt;</span> <span class=m>0</span> <span class=p>&amp;&amp;</span> <span class=n>_elements</span><span class=p>[</span><span class=m>0</span><span class=p>]</span> <span class=k>is</span> <span class=n>HtmlTitleElement</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>isHtml</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>             <span class=n>finalDocument</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;!DOCTYPE html&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>             <span class=n>finalDocument</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;html&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>             <span class=n>finalDocument</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;head&gt;&lt;title&gt;Generated Document&lt;/title&gt;&lt;/head&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>             <span class=n>finalDocument</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;body&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=kt>var</span> <span class=n>element</span> <span class=k>in</span> <span class=n>_elements</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>finalDocument</span><span class=p>.</span><span class=n>Append</span><span class=p>(</span><span class=n>element</span><span class=p>.</span><span class=n>Render</span><span class=p>());</span> <span class=c1>// è°ƒç”¨æ¯ä¸ªå…ƒç´ çš„æ¸²æŸ“æ–¹æ³•</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=k>if</span> <span class=p>(</span><span class=n>isHtml</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>             <span class=n>finalDocument</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;/body&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>             <span class=n>finalDocument</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;/html&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>finalDocument</span><span class=p>.</span><span class=n>ToString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Clear</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_elements</span><span class=p>.</span><span class=n>Clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- ç¤ºä¾‹ç”¨æ³• ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Program</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=k>void</span> <span class=n>Main</span><span class=p>(</span><span class=kt>string</span><span class=p>[]</span> <span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// --- é€‰æ‹© Markdown å·¥å‚ ---</span>
</span></span><span class=line><span class=cl>        <span class=n>ITextDocumentFactory</span> <span class=n>factory</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MarkdownDocumentFactory</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>DocumentAssembler</span> <span class=n>assembler</span> <span class=p>=</span> <span class=k>new</span> <span class=n>DocumentAssembler</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// å®¢æˆ·ç«¯ä½¿ç”¨å·¥å‚åˆ›å»ºé›¶ä»¶ï¼Œå¹¶æ·»åŠ åˆ°ç»„è£…å™¨</span>
</span></span><span class=line><span class=cl>        <span class=n>ITitleElement</span> <span class=n>mdTitle</span> <span class=p>=</span> <span class=n>factory</span><span class=p>.</span><span class=n>CreateTitle</span><span class=p>(</span><span class=s>&#34;My Markdown Document&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>assembler</span><span class=p>.</span><span class=n>AddElement</span><span class=p>(</span><span class=n>mdTitle</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>IContentElement</span> <span class=n>mdContent</span> <span class=p>=</span> <span class=n>factory</span><span class=p>.</span><span class=n>CreateContent</span><span class=p>(</span><span class=s>&#34;This is Markdown content.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>assembler</span><span class=p>.</span><span class=n>AddElement</span><span class=p>(</span><span class=n>mdContent</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// å®¢æˆ·ç«¯ç»„è£…å¹¶è·å–æœ€ç»ˆæ–‡æ¡£</span>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>markdownDoc</span> <span class=p>=</span> <span class=n>assembler</span><span class=p>.</span><span class=n>AssembleDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>markdownDoc</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// --- æ¸…ç†å¹¶åˆ‡æ¢åˆ° HTML å·¥å‚ ---</span>
</span></span><span class=line><span class=cl>        <span class=n>assembler</span><span class=p>.</span><span class=n>Clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>factory</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HtmlDocumentFactory</span><span class=p>();</span> <span class=c1>// æ›´æ¢å·¥å‚å®ä¾‹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// ä½¿ç”¨æ–°å·¥å‚åˆ›å»ºé›¶ä»¶</span>
</span></span><span class=line><span class=cl>        <span class=n>ITitleElement</span> <span class=n>htmlTitle</span> <span class=p>=</span> <span class=n>factory</span><span class=p>.</span><span class=n>CreateTitle</span><span class=p>(</span><span class=s>&#34;My HTML Document&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>assembler</span><span class=p>.</span><span class=n>AddElement</span><span class=p>(</span><span class=n>htmlTitle</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>IContentElement</span> <span class=n>htmlContent</span> <span class=p>=</span> <span class=n>factory</span><span class=p>.</span><span class=n>CreateContent</span><span class=p>(</span><span class=s>&#34;This is &lt;b&gt;HTML&lt;/b&gt; content.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>assembler</span><span class=p>.</span><span class=n>AddElement</span><span class=p>(</span><span class=n>htmlContent</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>         <span class=c1>// å®¢æˆ·ç«¯ä½¿ç”¨ç›¸åŒçš„ç»„è£…é€»è¾‘ï¼ˆä½†é›¶ä»¶ä¸åŒï¼‰</span>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>htmlDoc</span> <span class=p>=</span> <span class=n>assembler</span><span class=p>.</span><span class=n>AssembleDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>htmlDoc</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>classDiagram
</span></span><span class=line><span class=cl>    direction LR
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    %% --- Interfaces / Abstract Classes ---
</span></span><span class=line><span class=cl>    class ITextElement {
</span></span><span class=line><span class=cl>      &lt;&lt;Interface&gt;&gt;
</span></span><span class=line><span class=cl>      +Render() string
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    class ITitleElement {
</span></span><span class=line><span class=cl>      &lt;&lt;Interface&gt;&gt;
</span></span><span class=line><span class=cl>      # Inherits ITextElement
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    class IContentElement {
</span></span><span class=line><span class=cl>      &lt;&lt;Interface&gt;&gt;
</span></span><span class=line><span class=cl>      # Inherits ITextElement
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ITextElement &lt;|.. ITitleElement
</span></span><span class=line><span class=cl>    ITextElement &lt;|.. IContentElement
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    class ITextDocumentFactory {
</span></span><span class=line><span class=cl>      &lt;&lt;Interface&gt;&gt;
</span></span><span class=line><span class=cl>      +CreateTitle(text: string) ITitleElement
</span></span><span class=line><span class=cl>      +CreateContent(text: string) IContentElement
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    %% --- Concrete Products ---
</span></span><span class=line><span class=cl>    class MarkdownTitleElement {
</span></span><span class=line><span class=cl>      -text: string
</span></span><span class=line><span class=cl>      +Render() string
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    class MarkdownContentElement {
</span></span><span class=line><span class=cl>      -text: string
</span></span><span class=line><span class=cl>      +Render() string
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    class HtmlTitleElement {
</span></span><span class=line><span class=cl>      -text: string
</span></span><span class=line><span class=cl>      +Render() string
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    class HtmlContentElement {
</span></span><span class=line><span class=cl>      -text: string
</span></span><span class=line><span class=cl>      +Render() string
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    %% --- Concrete Factories ---
</span></span><span class=line><span class=cl>    class MarkdownDocumentFactory {
</span></span><span class=line><span class=cl>      +CreateTitle(text: string) ITitleElement
</span></span><span class=line><span class=cl>      +CreateContent(text: string) IContentElement
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    class HtmlDocumentFactory {
</span></span><span class=line><span class=cl>      +CreateTitle(text: string) ITitleElement
</span></span><span class=line><span class=cl>      +CreateContent(text: string) IContentElement
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    %% --- Client ---
</span></span><span class=line><span class=cl>    class DocumentAssembler {
</span></span><span class=line><span class=cl>      -elements: List~ITextElement~
</span></span><span class=line><span class=cl>      +AddElement(element: ITextElement) void
</span></span><span class=line><span class=cl>      +AssembleDocument() string
</span></span><span class=line><span class=cl>      +Clear() void
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    class Program {
</span></span><span class=line><span class=cl>      +Main(args: string[]) void
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    %% --- Relationships ---
</span></span><span class=line><span class=cl>    ITitleElement &lt;|.. MarkdownTitleElement
</span></span><span class=line><span class=cl>    IContentElement &lt;|.. MarkdownContentElement
</span></span><span class=line><span class=cl>    ITitleElement &lt;|.. HtmlTitleElement
</span></span><span class=line><span class=cl>    IContentElement &lt;|.. HtmlContentElement
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ITextDocumentFactory &lt;|.. MarkdownDocumentFactory
</span></span><span class=line><span class=cl>    ITextDocumentFactory &lt;|.. HtmlDocumentFactory
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    MarkdownDocumentFactory ..&gt; MarkdownTitleElement : creates
</span></span><span class=line><span class=cl>    MarkdownDocumentFactory ..&gt; MarkdownContentElement : creates
</span></span><span class=line><span class=cl>    HtmlDocumentFactory ..&gt; HtmlTitleElement : creates
</span></span><span class=line><span class=cl>    HtmlDocumentFactory ..&gt; HtmlContentElement : creates
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    DocumentAssembler ..&gt; ITextDocumentFactory : uses
</span></span><span class=line><span class=cl>    DocumentAssembler &#34;1&#34; o-- &#34;*&#34; ITextElement : aggregates
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Program ..&gt; DocumentAssembler : uses
</span></span><span class=line><span class=cl>    Program ..&gt; ITextDocumentFactory : uses
</span></span></code></pre></td></tr></table></div></div><h5 id=å¤šæŠ½è±¡çš„å®ç°>å¤šæŠ½è±¡çš„å®ç°</h5><p>â€‹ è¿™ä¸ªå·¥å‚çš„ä½¿ç”¨å…¶å®æ˜¯æœ‰äº›åˆ«æ‰­çš„ï¼Œä¾‹å¦‚æˆ‘ä»¬éœ€è¦å¯¹htmlè¿›è¡Œé¢å¤–çš„åˆ¤æ–­ï¼Œä¹Ÿè®¸æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªåˆ¤æ–­ä¹Ÿä½œä¸ºäº§å“çš„ä¸€éƒ¨åˆ†ï¼Ÿ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>System</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Collections.Generic</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- 1. Abstract Products ---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ä¿æŒä¸å˜: ä»£è¡¨å¯æ¸²æŸ“çš„ç‹¬ç«‹å…ƒç´ </span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>ITextElement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>string</span> <span class=n>Render</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>ITitleElement</span> <span class=p>:</span> <span class=n>ITextElement</span> <span class=p>{</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>IContentElement</span> <span class=p>:</span> <span class=n>ITextElement</span> <span class=p>{</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æ–°å¢: ä»£è¡¨æ•´ä¸ªæ–‡æ¡£çš„ç»“æ„/å®¹å™¨</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>IDocument</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>void</span> <span class=n>AddElement</span><span class=p>(</span><span class=n>ITextElement</span> <span class=n>element</span><span class=p>);</span> <span class=c1>// å‘æ–‡æ¡£ç»“æ„ä¸­æ·»åŠ å…ƒç´ </span>
</span></span><span class=line><span class=cl>    <span class=kt>string</span> <span class=n>RenderDocument</span><span class=p>();</span>               <span class=c1>// æ¸²æŸ“æ•´ä¸ªæ–‡æ¡£ï¼ŒåŒ…å«å¿…è¦çš„ç»“æ„æ ‡ç­¾</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- 2. Concrete Products ---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- Markdown äº§å“ ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MarkdownTitleElement</span> <span class=p>:</span> <span class=n>ITitleElement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=kt>string</span> <span class=n>_text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>MarkdownTitleElement</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span> <span class=p>{</span> <span class=n>_text</span> <span class=p>=</span> <span class=n>text</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Render</span><span class=p>()</span> <span class=p>=&gt;</span> <span class=s>$&#34;# {_text}\n&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MarkdownContentElement</span> <span class=p>:</span> <span class=n>IContentElement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=kt>string</span> <span class=n>_text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>MarkdownContentElement</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span> <span class=p>{</span> <span class=n>_text</span> <span class=p>=</span> <span class=n>text</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Render</span><span class=p>()</span> <span class=p>=&gt;</span> <span class=s>$&#34;{_text}\n&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æ–°å¢: Markdown æ–‡æ¡£ç»“æ„äº§å“</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MarkdownDocument</span> <span class=p>:</span> <span class=n>IDocument</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>ITextElement</span><span class=p>&gt;</span> <span class=n>_elements</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>ITextElement</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>AddElement</span><span class=p>(</span><span class=n>ITextElement</span> <span class=n>element</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_elements</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=n>element</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Markdown é€šå¸¸ä¸éœ€è¦ç‰¹æ®Šçš„å…¨å±€åŒ…è£…å™¨</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>RenderDocument</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>StringBuilder</span> <span class=n>sb</span> <span class=p>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=kt>var</span> <span class=n>element</span> <span class=k>in</span> <span class=n>_elements</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>sb</span><span class=p>.</span><span class=n>Append</span><span class=p>(</span><span class=n>element</span><span class=p>.</span><span class=n>Render</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>sb</span><span class=p>.</span><span class=n>ToString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- HTML äº§å“ ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>HtmlTitleElement</span> <span class=p>:</span> <span class=n>ITitleElement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=kt>string</span> <span class=n>_text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>HtmlTitleElement</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span> <span class=p>{</span> <span class=n>_text</span> <span class=p>=</span> <span class=n>text</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Render</span><span class=p>()</span> <span class=p>=&gt;</span> <span class=s>$&#34;    &lt;h1&gt;{_text}&lt;/h1&gt;\n&#34;</span><span class=p>;</span> <span class=c1>// Indentation for readability</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>HtmlContentElement</span> <span class=p>:</span> <span class=n>IContentElement</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>readonly</span> <span class=kt>string</span> <span class=n>_text</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>HtmlContentElement</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span> <span class=p>{</span> <span class=n>_text</span> <span class=p>=</span> <span class=n>text</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Render</span><span class=p>()</span> <span class=p>=&gt;</span> <span class=s>$&#34;    &lt;p&gt;{_text}&lt;/p&gt;\n&#34;</span><span class=p>;</span> <span class=c1>// Indentation for readability</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// æ–°å¢: HTML æ–‡æ¡£ç»“æ„äº§å“</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>HtmlDocument</span> <span class=p>:</span> <span class=n>IDocument</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>ITextElement</span><span class=p>&gt;</span> <span class=n>_elements</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>ITextElement</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>string</span> <span class=n>_pageTitle</span> <span class=p>=</span> <span class=s>&#34;Generated Document&#34;</span><span class=p>;</span> <span class=c1>// Default title</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>AddElement</span><span class=p>(</span><span class=n>ITextElement</span> <span class=n>element</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_elements</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=n>element</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// HTML æ–‡æ¡£çš„æ¸²æŸ“åŒ…å«äº†å¿…è¦çš„åŒ…è£…æ ‡ç­¾</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>RenderDocument</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>StringBuilder</span> <span class=n>sb</span> <span class=p>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>sb</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;!DOCTYPE html&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>sb</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;html&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>sb</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;head&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>sb</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>$&#34;&lt;title&gt;{_pageTitle}&lt;/title&gt;&#34;</span><span class=p>);</span> <span class=c1>// Use the stored title</span>
</span></span><span class=line><span class=cl>        <span class=n>sb</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;/head&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>sb</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;body&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>foreach</span> <span class=p>(</span><span class=kt>var</span> <span class=n>element</span> <span class=k>in</span> <span class=n>_elements</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>sb</span><span class=p>.</span><span class=n>Append</span><span class=p>(</span><span class=n>element</span><span class=p>.</span><span class=n>Render</span><span class=p>());</span> <span class=c1>// Append rendered element</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>sb</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;/body&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>sb</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;/html&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>sb</span><span class=p>.</span><span class=n>ToString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- 3. Abstract Factory ---</span>
</span></span><span class=line><span class=cl><span class=c1>// æ·»åŠ åˆ›å»º IDocument çš„æ–¹æ³•</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>ITextDocumentFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>IDocument</span> <span class=n>CreateDocument</span><span class=p>();</span> <span class=c1>// åˆ›å»ºæ–‡æ¡£ç»“æ„å¯¹è±¡</span>
</span></span><span class=line><span class=cl>    <span class=n>ITitleElement</span> <span class=n>CreateTitle</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>IContentElement</span> <span class=n>CreateContent</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- 4. Concrete Factories ---</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- Markdown å·¥å‚ ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MarkdownDocumentFactory</span> <span class=p>:</span> <span class=n>ITextDocumentFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>IDocument</span> <span class=n>CreateDocument</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>MarkdownDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>ITitleElement</span> <span class=n>CreateTitle</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>MarkdownTitleElement</span><span class=p>(</span><span class=n>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>IContentElement</span> <span class=n>CreateContent</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>MarkdownContentElement</span><span class=p>(</span><span class=n>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- HTML å·¥å‚ ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>HtmlDocumentFactory</span> <span class=p>:</span> <span class=n>ITextDocumentFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=kd>public</span> <span class=n>IDocument</span> <span class=n>CreateDocument</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>HtmlDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>ITitleElement</span> <span class=n>CreateTitle</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>HtmlTitleElement</span><span class=p>(</span><span class=n>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>IContentElement</span> <span class=n>CreateContent</span><span class=p>(</span><span class=kt>string</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>HtmlContentElement</span><span class=p>(</span><span class=n>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- 5. Client Code ---</span>
</span></span><span class=line><span class=cl><span class=c1>// å®¢æˆ·ç«¯ç°åœ¨å˜å¾—æ›´é€šç”¨ï¼Œä¸å†å…³å¿ƒå…·ä½“æ ¼å¼çš„åŒ…è£…ç»†èŠ‚</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>DocumentGeneratorClient</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>ITextDocumentFactory</span> <span class=n>_factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>DocumentGeneratorClient</span><span class=p>(</span><span class=n>ITextDocumentFactory</span> <span class=n>factory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_factory</span> <span class=p>=</span> <span class=n>factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Generate</span><span class=p>(</span><span class=kt>string</span> <span class=n>title</span><span class=p>,</span> <span class=kt>string</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 1. åˆ›å»ºæ–‡æ¡£ç»“æ„å¯¹è±¡ (ç”±å·¥å‚å†³å®šæ˜¯ MarkdownDocument è¿˜æ˜¯ HtmlDocument)</span>
</span></span><span class=line><span class=cl>        <span class=n>IDocument</span> <span class=n>document</span> <span class=p>=</span> <span class=n>_factory</span><span class=p>.</span><span class=n>CreateDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 2. åˆ›å»ºå…·ä½“çš„å…ƒç´  (ç”±å·¥å‚å†³å®šæ˜¯ Markdown è¿˜æ˜¯ HTML å…ƒç´ )</span>
</span></span><span class=line><span class=cl>        <span class=n>ITitleElement</span> <span class=n>titleElement</span> <span class=p>=</span> <span class=n>_factory</span><span class=p>.</span><span class=n>CreateTitle</span><span class=p>(</span><span class=n>title</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>IContentElement</span> <span class=n>contentElement</span> <span class=p>=</span> <span class=n>_factory</span><span class=p>.</span><span class=n>CreateContent</span><span class=p>(</span><span class=n>content</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 3. å°†å…ƒç´ æ·»åŠ åˆ°æ–‡æ¡£ç»“æ„ä¸­</span>
</span></span><span class=line><span class=cl>        <span class=n>document</span><span class=p>.</span><span class=n>AddElement</span><span class=p>(</span><span class=n>titleElement</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>document</span><span class=p>.</span><span class=n>AddElement</span><span class=p>(</span><span class=n>contentElement</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 4. è¯·æ±‚æ–‡æ¡£ç»“æ„å¯¹è±¡è¿›è¡Œæœ€ç»ˆæ¸²æŸ“</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>document</span><span class=p>.</span><span class=n>RenderDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>     <span class=kd>public</span> <span class=k>void</span> <span class=n>SetFactory</span><span class=p>(</span><span class=n>ITextDocumentFactory</span> <span class=n>factory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_factory</span> <span class=p>=</span> <span class=n>factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- ç¤ºä¾‹ç”¨æ³• ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Program</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=k>void</span> <span class=n>Main</span><span class=p>(</span><span class=kt>string</span><span class=p>[]</span> <span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// --- ä½¿ç”¨ Markdown å·¥å‚ ---</span>
</span></span><span class=line><span class=cl>        <span class=n>ITextDocumentFactory</span> <span class=n>factory</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MarkdownDocumentFactory</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>DocumentGeneratorClient</span> <span class=n>client</span> <span class=p>=</span> <span class=k>new</span> <span class=n>DocumentGeneratorClient</span><span class=p>(</span><span class=n>factory</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>markdownDoc</span> <span class=p>=</span> <span class=n>client</span><span class=p>.</span><span class=n>Generate</span><span class=p>(</span><span class=s>&#34;My Markdown Document&#34;</span><span class=p>,</span> <span class=s>&#34;This is Markdown content.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>markdownDoc</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// --- åˆ‡æ¢åˆ° HTML å·¥å‚ ---</span>
</span></span><span class=line><span class=cl>        <span class=n>client</span><span class=p>.</span><span class=n>SetFactory</span><span class=p>(</span><span class=k>new</span> <span class=n>HtmlDocumentFactory</span><span class=p>());</span> <span class=c1>// æ›´æ¢å·¥å‚å®ä¾‹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>htmlDoc</span> <span class=p>=</span> <span class=n>client</span><span class=p>.</span><span class=n>Generate</span><span class=p>(</span><span class=s>&#34;My HTML Document&#34;</span><span class=p>,</span> <span class=s>&#34;This is &lt;b&gt;HTML&lt;/b&gt; content.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>htmlDoc</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h5 id=å€ŸåŠ©å»ºé€ è€…æ¨¡å¼çš„å®ç°>å€ŸåŠ©å»ºé€ è€…æ¨¡å¼çš„å®ç°</h5><p>â€‹ åœ¨å­¦ä¹ äº†å»ºé€ è€…æ¨¡å¼ï¼Œå›è¿‡å¤´æ¥ï¼Œå¯ä»¥å‘ç°å…¶å®DocumentGeneratorClientæ˜¯ä¸€ä¸ªDirectorï¼Œä»–ä»¬çš„è¡Œä¸ºä¹Ÿå¾ˆç›¸ä¼¼ï¼Œä¾‹å¦‚åˆ›å»ºæ–‡æ¡£å¯¹è±¡ã€æ·»åŠ å…ƒç´ ã€ç”Ÿæˆæ–‡æ¡£å†…å®¹ï¼Œè¿™ä¸ªæ­¥éª¤å’Œå»ºé€ è€…åŸºæœ¬ä¸€è‡´</p><p>â€‹ ä½†ä¸åŒç‚¹åœ¨äºå·¥å‚è¿”å›äº†å¤šä¸ªåŒæ—çš„å¯¹è±¡ï¼Œå¦å¤–ï¼Œå°½ç®¡IDocumentå’ŒITextElementæ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œä½†ä»–ä»¬ä¹Ÿæ˜¯åŒæ—çš„ï¼Œè¿™é‡Œçš„æ¦‚å¿µåœ¨äºä»–ä»¬éƒ½æ˜¯Markdown/Htmlæ ¼å¼ï¼Œè€Œéåœ¨äºä»–ä»¬éƒ½æ˜¯å®ç°æŸä¸ªæ¥å£</p><p>â€‹ ä¸‹é¢æˆ‘ä»¬å°è¯•ç”¨æ¥è¿‘å»ºé€ è€…æ¨¡å¼çš„å·¥å‚æ¨¡å¼è¿›è¡Œå°è¯•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// 1. Abstract Factory (æŠ½è±¡å·¥å‚)</span>
</span></span><span class=line><span class=cl><span class=c1>// å®šä¹‰äº†åˆ›å»ºæ–‡æ¡£å„ä¸ªéƒ¨åˆ†ï¼ˆäº§å“ï¼‰ä»¥åŠè·å–æœ€ç»ˆç»“æœçš„æ¥å£</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>abstract</span> <span class=k>class</span> <span class=nc>TextDocumentFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// å»ºé€ è€…çš„æ„å»ºæ­¥éª¤</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>abstract</span> <span class=k>void</span> <span class=n>AddTitle</span><span class=p>(</span><span class=kt>string</span> <span class=n>title</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>abstract</span> <span class=k>void</span> <span class=n>AddContent</span><span class=p>(</span><span class=kt>string</span> <span class=n>content</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// è·å–æœ€ç»ˆäº§å“ï¼ˆæ•´ä¸ªæ ¼å¼åŒ–åçš„æ–‡æ¡£ï¼‰</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>abstract</span> <span class=kt>string</span> <span class=n>GetResult</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// é‡ç½®å·¥å‚çŠ¶æ€ï¼Œä»¥ä¾¿åˆ›å»ºæ–°æ–‡æ¡£</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>abstract</span> <span class=k>void</span> <span class=n>Reset</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 2. Concrete Factories (å…·ä½“å·¥å‚)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- Markdown å·¥å‚ ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MarkdownFactory</span> <span class=p>:</span> <span class=n>TextDocumentFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>StringBuilder</span> <span class=n>_document</span> <span class=p>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>Reset</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>Clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>AddTitle</span><span class=p>(</span><span class=kt>string</span> <span class=n>title</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>$&#34;# {title}&#34;</span><span class=p>);</span> <span class=c1>// Markdown H1 æ ‡é¢˜</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>();</span> <span class=c1>// æ·»åŠ ç©ºè¡Œ</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>AddContent</span><span class=p>(</span><span class=kt>string</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=n>content</span><span class=p>);</span> <span class=c1>// Markdown æ®µè½</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>();</span> <span class=c1>// æ·»åŠ ç©ºè¡Œ</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// è¿”å›æ„å»ºå¥½çš„ Markdown å­—ç¬¦ä¸²</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>override</span> <span class=kt>string</span> <span class=n>GetResult</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>result</span> <span class=p>=</span> <span class=n>_document</span><span class=p>.</span><span class=n>ToString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Reset(); // å¯ä»¥åœ¨è·å–ç»“æœåè‡ªåŠ¨é‡ç½®</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- HTML å·¥å‚ ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>HtmlFactory</span> <span class=p>:</span> <span class=n>TextDocumentFactory</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>StringBuilder</span> <span class=n>_document</span> <span class=p>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>bool</span> <span class=n>_bodyOpened</span> <span class=p>=</span> <span class=kc>false</span><span class=p>;</span> <span class=c1>// ç®€å•çŠ¶æ€è·Ÿè¸ª</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>     <span class=kd>public</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>Reset</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>Clear</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>_bodyOpened</span> <span class=p>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;!DOCTYPE html&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;html&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;head&gt;&lt;title&gt;Generated Document&lt;/title&gt;&lt;/head&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=k>void</span> <span class=n>EnsureBodyOpened</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(!</span><span class=n>_bodyOpened</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;body&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>_bodyOpened</span> <span class=p>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>AddTitle</span><span class=p>(</span><span class=kt>string</span> <span class=n>title</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>EnsureBodyOpened</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>$&#34;    &lt;h1&gt;{title}&lt;/h1&gt;&#34;</span><span class=p>);</span> <span class=c1>// HTML H1 æ ‡é¢˜</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>override</span> <span class=k>void</span> <span class=n>AddContent</span><span class=p>(</span><span class=kt>string</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>         <span class=n>EnsureBodyOpened</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>$&#34;    &lt;p&gt;{content}&lt;/p&gt;&#34;</span><span class=p>);</span> <span class=c1>// HTML æ®µè½</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// è¿”å›æ„å»ºå¥½çš„ HTML å­—ç¬¦ä¸²</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>override</span> <span class=kt>string</span> <span class=n>GetResult</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>_bodyOpened</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>             <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;/body&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>_document</span><span class=p>.</span><span class=n>AppendLine</span><span class=p>(</span><span class=s>&#34;&lt;/html&gt;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>result</span> <span class=p>=</span> <span class=n>_document</span><span class=p>.</span><span class=n>ToString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>       <span class=c1>// Reset(); // å¯ä»¥åœ¨è·å–ç»“æœåè‡ªåŠ¨é‡ç½®</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 3. Client Code (å®¢æˆ·ç«¯ä»£ç )</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>DocumentGenerator</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// å®¢æˆ·ç«¯ä¾èµ–äºæŠ½è±¡å·¥å‚æ¥å£</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>TextDocumentFactory</span> <span class=n>_factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>DocumentGenerator</span><span class=p>(</span><span class=n>TextDocumentFactory</span> <span class=n>factory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>_factory</span> <span class=p>=</span> <span class=n>factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>_factory</span><span class=p>.</span><span class=n>Reset</span><span class=p>();</span> <span class=c1>// åˆå§‹åŒ–æ—¶é‡ç½®å·¥å‚</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// å®¢æˆ·ç«¯ä½¿ç”¨å·¥å‚æ¥æ„å»ºæ–‡æ¡£ï¼Œä¸å…³å¿ƒå…·ä½“æ ¼å¼</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>GenerateDocument</span><span class=p>(</span><span class=kt>string</span> <span class=n>title</span><span class=p>,</span> <span class=kt>string</span> <span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// æ³¨æ„ï¼šè¿™é‡Œå®¢æˆ·ç«¯è°ƒç”¨çš„é¡ºåºå†³å®šäº†æ–‡æ¡£ç»“æ„</span>
</span></span><span class=line><span class=cl>        <span class=n>_factory</span><span class=p>.</span><span class=n>AddTitle</span><span class=p>(</span><span class=n>title</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>_factory</span><span class=p>.</span><span class=n>AddContent</span><span class=p>(</span><span class=n>content</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// å¯ä»¥æ·»åŠ æ›´å¤šæ­¥éª¤ï¼Œå¦‚ AddSection, AddImage ç­‰ï¼Œåªè¦åœ¨ Factory æ¥å£å’Œå®ç°ä¸­å®šä¹‰</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>_factory</span><span class=p>.</span><span class=n>GetResult</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>     <span class=c1>// å…è®¸æ›´æ¢å·¥å‚</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>SetFactory</span><span class=p>(</span><span class=n>TextDocumentFactory</span> <span class=n>factory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>_factory</span> <span class=p>=</span> <span class=n>factory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>_factory</span><span class=p>.</span><span class=n>Reset</span><span class=p>();</span> <span class=c1>// æ›´æ¢åé‡ç½®</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// --- ç¤ºä¾‹ç”¨æ³• ---</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Program</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=k>void</span> <span class=n>Main</span><span class=p>(</span><span class=kt>string</span><span class=p>[]</span> <span class=n>args</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// --- ä½¿ç”¨ Markdown å·¥å‚ ---</span>
</span></span><span class=line><span class=cl>        <span class=n>TextDocumentFactory</span> <span class=n>markdownFactory</span> <span class=p>=</span> <span class=k>new</span> <span class=n>MarkdownFactory</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>DocumentGenerator</span> <span class=n>generator</span> <span class=p>=</span> <span class=k>new</span> <span class=n>DocumentGenerator</span><span class=p>(</span><span class=n>markdownFactory</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>markdownDoc</span> <span class=p>=</span> <span class=n>generator</span><span class=p>.</span><span class=n>GenerateDocument</span><span class=p>(</span><span class=s>&#34;My Markdown Document&#34;</span><span class=p>,</span> <span class=s>&#34;This is the content in Markdown format.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>markdownDoc</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// --- åˆ‡æ¢åˆ° HTML å·¥å‚ ---</span>
</span></span><span class=line><span class=cl>        <span class=n>TextDocumentFactory</span> <span class=n>htmlFactory</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HtmlFactory</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>generator</span><span class=p>.</span><span class=n>SetFactory</span><span class=p>(</span><span class=n>htmlFactory</span><span class=p>);</span> <span class=c1>// æ›´æ¢ç”Ÿæˆå™¨çš„å·¥å‚</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>string</span> <span class=n>htmlDoc</span> <span class=p>=</span> <span class=n>generator</span><span class=p>.</span><span class=n>GenerateDocument</span><span class=p>(</span><span class=s>&#34;My HTML Document&#34;</span><span class=p>,</span> <span class=s>&#34;This is the content in &lt;b&gt;HTML&lt;/b&gt; format.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Console</span><span class=p>.</span><span class=n>WriteLine</span><span class=p>(</span><span class=n>htmlDoc</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>â€‹ æˆ‘ä¸ªäººæ˜¯æ›´å€¾å‘äºè¿™ç§å®ç°çš„ï¼Œååˆ†çš„ç®€æ´ï¼Œä½†å¯èƒ½ä¸å¤ªé€‚åº”æ›´å¤æ‚çš„åœºæ™¯ï¼Œåªç”¨äºç”ŸæˆæŸä¸ªæ ¼å¼çš„æ–‡æ¡£å†…å®¹</p><p>â€‹ ä»¥å»ºé€ è€…æ¨¡å¼çš„è§’åº¦æ¥çœ‹ï¼Œå…¶ä¸­DocumentGeneratorç®—æ˜¯Directorï¼ŒFactoryçš„å…·ä½“ç±»æ˜¯Builderï¼Œäº§å“æ˜¯string</p><h2 id=åŸå‹æ–¹æ³•>åŸå‹æ–¹æ³•</h2><p>â€‹ ä¸æ˜¯é€šè¿‡ç±»ï¼ˆæ„é€ å‡½æ•°ï¼‰è·å¾—å®ä¾‹ï¼Œè€Œæ˜¯é€šè¿‡ç±»çš„å®ä¾‹å¤åˆ¶å¾—åˆ°å®ä¾‹</p><h3 id=å®ç°æ–¹æ³•-1>å®ç°æ–¹æ³•</h3><p>â€‹ ä¸€èˆ¬æ¥è®²ï¼Œå°±æ˜¯å®ç°ä¸€ä¸ªæ¥å£å®ç°å…‹éš†ï¼Œå¦‚JAVAä¸­çš„Cloneableæ¥å£</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Info</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Cloneable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>text</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>Info</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>id</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>text</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>id</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>text</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>text</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=nf>clone</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CloneNotSupportedException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    	</span><span class=k>return</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>clone</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=æ·±æ‹·è´>æ·±æ‹·è´</h3><p>â€‹ æœ‰æ—¶å€™éœ€è¦æ‹·è´å¼•ç”¨å¯¹è±¡çš„å€¼ï¼Œè€Œéå¼•ç”¨åŒä¸€å¯¹è±¡ï¼Œè¿™æ—¶éœ€è¦å¯¹å…¶ä¸­çš„å¼•ç”¨è¿›è¡Œæ‹·è´</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>File</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>Cloneable</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>text</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Info</span><span class=w> </span><span class=n>info</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=nf>File</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>text</span><span class=p>,</span><span class=w> </span><span class=n>Info</span><span class=w> </span><span class=n>info</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>text</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>text</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>this</span><span class=p>.</span><span class=na>info</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>info</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>protected</span><span class=w> </span><span class=n>Object</span><span class=w> </span><span class=nf>clone</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>CloneNotSupportedException</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>File</span><span class=w> </span><span class=n>file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kd>super</span><span class=p>.</span><span class=na>clone</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>file</span><span class=p>.</span><span class=na>info</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>file</span><span class=p>.</span><span class=na>info</span><span class=p>.</span><span class=na>clone</span><span class=p>();</span><span class=w> </span><span class=c1>// æ‹·è´å¼•ç”¨å¯¹è±¡çš„å€¼ï¼Œç”Ÿæˆæ–°å®ä¾‹</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    	</span><span class=k>return</span><span class=w> </span><span class=n>file</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=å»ºé€ è€…æ¨¡å¼>å»ºé€ è€…æ¨¡å¼</h2><p>â€‹ ç”¨äºæ„å»ºè¾ƒä¸ºå¤æ‚ä½†å¯ä»¥é€šè¿‡ç»„åˆæ¥ç”Ÿæˆçš„å¯¹è±¡</p><p>â€‹ ä»¥æ„å»ºè§’è‰²ä¸ºä¾‹ï¼Œä¸‹é¢çš„ä¾‹å­å€ŸåŠ©äº†Directorå’Œæµå¼æ¥å£ã€‚
â€‹ æŒ‡æŒ¥è€…ç±»CharacterDirectoréš”ç¦»äº†ç”¨æˆ·å’Œå®é™…çš„ç”Ÿäº§è¿‡ç¨‹ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å¤–éƒ¨ç›´æ¥å»ç”ŸæˆCharacter Builderå®ä¾‹ï¼Œé€šè¿‡è¿™ä¸ªå»ºé€ è€…å®ä¾‹å»ç”ŸæˆCharacterå®ä¾‹</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Character</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>weapon</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span><span class=p>(</span><span class=n>Character</span> <span class=n>character</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>name</span> <span class=p>=</span> <span class=n>character</span><span class=p>.</span><span class=n>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>weapon</span> <span class=p>=</span> <span class=n>character</span><span class=p>.</span><span class=n>weapon</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>interface</span> <span class=nc>ICharacterBuilder</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>Create</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>SetName</span><span class=p>(</span><span class=kt>string</span> <span class=n>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>SetWeapon</span><span class=p>(</span><span class=kt>string</span> <span class=n>weapon</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>CharacterBuilder</span> <span class=p>:</span> <span class=n>ICharacterBuilder</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Character</span> <span class=n>_character</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>Create</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>Character</span><span class=p>(</span><span class=n>_character</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>SetName</span><span class=p>(</span><span class=kt>string</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>name</span> <span class=p>=</span> <span class=n>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>SetWeapon</span><span class=p>(</span><span class=kt>string</span> <span class=n>weapon</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>weapon</span> <span class=p>=</span> <span class=n>weapon</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>CharacterDirector</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>CharacterBuilder</span> <span class=n>_builder</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>CharacterDirector</span><span class=p>(</span><span class=n>CharacterBuilder</span> <span class=n>builder</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_builder</span> <span class=p>=</span> <span class=n>builder</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>CreateWarrior</span><span class=p>(</span><span class=kt>string</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>result</span> <span class=p>=</span> <span class=n>_builder</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>SetName</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>SetWeapon</span><span class=p>(</span><span class=s>&#34;Sword&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>CreateMgician</span><span class=p>(</span><span class=kt>string</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>result</span> <span class=p>=</span> <span class=n>_builder</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>SetName</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>SetWeapon</span><span class=p>(</span><span class=s>&#34;Wand&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>â€‹ ä¸‹é¢ç»™å‡ºå¦ä¸€ç§åˆ›å»ºçš„å®ç°ï¼Œä½†éœ€è¦ä»”ç»†æ€è€ƒè¿™æ˜¯å¦ç¬¦åˆå»ºé€ è€…æ¨¡å¼ï¼Ÿ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Character</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>weapon</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>SetName</span><span class=p>(</span><span class=kt>string</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>name</span> <span class=p>=</span> <span class=n>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>SetWeapon</span><span class=p>(</span><span class=kt>string</span> <span class=n>weapon</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>weapon</span> <span class=p>=</span> <span class=n>weapon</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>void</span> <span class=n>CharacterDirector</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>CreateWarrior</span><span class=p>(</span><span class=kt>string</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>result</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Character</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>SetName</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>SetWeapon</span><span class=p>(</span><span class=s>&#34;Sword&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Character</span> <span class=n>CreateMgician</span><span class=p>(</span><span class=kt>string</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Character</span> <span class=n>result</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Character</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>SetName</span><span class=p>(</span><span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>.</span><span class=n>SetWeapon</span><span class=p>(</span><span class=s>&#34;Wand&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>â€‹ å®é™…ä¸Šä¸Šè¿°ä»£ç æ›´æ¥è¿‘äºç®€å•å·¥å‚ï¼ŒDirectorå’Œæµå¼æ–¹æ³•çš„åº”ç”¨å¹¶ä¸ä»£è¡¨ç€ä½¿ç”¨äº†å»ºé€ è€…æ–¹æ³•</p><p>â€‹ å»ºé€ è€…æ¨¡å¼åˆ†ç¦»äº†æ„å»ºå’Œè¡¨ç¤ºï¼Œä¹Ÿå°±æ˜¯åˆ†ç¦»äº†<strong>æ„å»ºçš„æ­¥éª¤</strong>å’Œ<strong>å®é™…çš„å¯¹è±¡å†…å®¹</strong>
â€‹ æ„æ€æ˜¯ï¼Œæˆ‘ä»¬å®šä¹‰äº†æ„å»ºçš„æ­¥éª¤ï¼Œä½†æœ€ç»ˆè·å¾—çš„å†…å®¹ä¸æ˜¯æ”¹å˜æ­¥éª¤æœ¬èº«çš„å®šä¹‰å®ç°çš„ï¼Œè€Œæ˜¯é€šè¿‡<strong>å…·ä½“å»ºé€ è€…å®ç°ç±» å¯¹æ„å»ºæ­¥éª¤çš„å…·ä½“å®ç°</strong> å’Œ <strong>å®¢æˆ·ç«¯/Director å¯¹è¿™äº›æ­¥éª¤çš„é€‰æ‹©æ€§è°ƒç”¨ä¸å‚æ•°ä¼ é€’</strong></p><h2 id=æ¡¥æ¥æ¨¡å¼>æ¡¥æ¥æ¨¡å¼</h2><p>â€‹ æ¡¥æ¥æ¨¡å¼æ˜¯ä¸ºäº†ä¼˜åŒ–åŠŸèƒ½ç»„åˆçš„å®ç°ï¼Œå¯¹äºæœ‰<strong>ä¸¤ä¸ª</strong>å˜åŒ–ç»´åº¦çš„ç³»ç»Ÿï¼Œé€šè¿‡å°†æŠ½è±¡å’Œè¡Œä¸ºåˆ†ç¦»ï¼Œç”¨ç»„åˆä»£æ›¿ç»§æ‰¿ï¼Œé™ä½è€¦åˆï¼Œæ˜“äºä¿®æ”¹</p><p>â€‹ ä¾‹å¦‚ï¼Œæˆ‘æœ‰ä¸€ä¸ªå’–å•¡ï¼Œä»–æœ‰ä¸­æ¯å’Œå¤§æ¯ï¼Œæœ‰åŠ å¥¶å’Œä¸åŠ ï¼Œæˆ‘ä»¬å¯ä»¥åšå››ç§ç±»ï¼Œä½†å¦‚æ­¤åšçš„è¯åœ¨å°†æ¥æƒ³è¦åŠ å…¥æ–°çš„è¶…å¤§æ¯ï¼Œä¼šå¾ˆå¤æ‚ï¼›ä¹Ÿå¯ä»¥åˆ†ç¦»è¿™ä¸¤ä¸ªç»´åº¦ï¼Œè¿™é‡Œé€‰æ‹©å°†å’–å•¡çš„å¤§å°ä½œä¸ºæŠ½è±¡ï¼ŒåŠ å¥¶å’Œä¸åŠ å¥¶æ˜¯å®ç°</p><h3 id=å®ç°æ–¹æ³•-2>å®ç°æ–¹æ³•</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>Coffee</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>CoffeeImp</span> <span class=n>CoffeeImp</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=kd>private</span> <span class=k>set</span><span class=p>;}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>SetCoffeeImp</span><span class=p>(</span><span class=n>CoffeeImp</span> <span class=n>coffeeImp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>_coffeeImp</span> <span class=p>=</span> <span class=n>coffeeImp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>abstract</span> <span class=k>void</span> <span class=n>PourCoffee</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MediumCoffee</span> <span class=p>:</span> <span class=n>Coffee</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>PourCoffee</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span> <span class=m>2</span><span class=p>;</span> <span class=n>i</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>CoffeeImp</span><span class=p>.</span><span class=n>Pour</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=p>.</span><span class=n>Print</span><span class=p>(</span><span class=s>&#34;ä¸­æ¯&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>SuperSizeCoffee</span> <span class=p>:</span> <span class=n>Coffee</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>PourCoffee</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span> <span class=m>3</span><span class=p>;</span> <span class=n>i</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>CoffeeImp</span><span class=p>.</span><span class=n>Pour</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=p>.</span><span class=n>Print</span><span class=p>(</span><span class=s>&#34;å¤§æ¯&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Imp -&gt; implement</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>CoffeeImp</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>abstract</span> <span class=k>void</span> <span class=n>Pour</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>NoMilkCoffeeImp</span> <span class=p>:</span> <span class=n>CoffeeImp</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Pour</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=p>.</span><span class=n>Print</span><span class=p>(</span><span class=s>&#34;æ— å¥¶çš„å’–å•¡&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>MilkCoffeeImp</span> <span class=p>:</span> <span class=n>CoffeeImp</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=k>void</span> <span class=n>Pour</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=p>.</span><span class=n>Print</span><span class=p>(</span><span class=s>&#34;åŠ å¥¶çš„å’–å•¡&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå’–å•¡å®é™…çš„è¡Œä¸ºå®ç°æ˜¯åœ¨CoffeeImpä¸­å®ç°çš„ï¼Œå’–å•¡æŠ½è±¡çš„å®ç°è°ƒç”¨äº†è¡Œä¸ºçš„å®ç°</p><h2 id=è£…é¥°å™¨æ¨¡å¼>è£…é¥°å™¨æ¨¡å¼</h2><h2 id=çŠ¶æ€æ¨¡å¼>çŠ¶æ€æ¨¡å¼</h2><p>â€‹ çŠ¶æ€æ¨¡å¼é€‚ç”¨äºå­˜åœ¨å¯æšä¸¾çš„çŠ¶æ€ã€ä¸”æ¯ä¸ªçŠ¶æ€æœ‰å…¶ç‰¹å®šçš„é€šç”¨è¡Œä¸º</p><p>â€‹ ä¸€èˆ¬å­˜åœ¨å¦‚ä¸‹ç±»ï¼šç¯å¢ƒç±»ï¼ˆæ‹¥æœ‰çŠ¶æ€çš„ç±»ï¼‰ã€æŠ½è±¡çŠ¶æ€ç±»ã€å…·ä½“çŠ¶æ€ç±»</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp></code></pre></td></tr></table></div></div><h2 id=è§‚å¯Ÿè€…æ¨¡å¼>è§‚å¯Ÿè€…æ¨¡å¼</h2></section><footer class=article-footer><section class=article-tags><a href=/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/>è®¾è®¡æ¨¡å¼</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 FallingHeaven</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>